<Window x:Class="SaleManagerApp.Views.ImportIngredientView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:viewmodels="clr-namespace:SaleManagerApp.ViewModels" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:helpers="clr-namespace:SaleManagerApp.Helpers" d:DataContext="{d:DesignInstance Type=viewmodels:ImportIngredientViewModel}"
        Title="Nhập kho"

        Width="450" Height="650"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="#F5F5F5">

    <Window.Resources>
        <helpers:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>
    </Window.Resources>


    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- HEADER -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="Nhập kho nguyên liệu"
                       FontSize="22"
                       FontWeight="Bold"
                       HorizontalAlignment="Center"/>
            <TextBlock Text="Chọn nguyên liệu và nhập số lượng"
                       FontSize="12"
                       Foreground="#666"
                       HorizontalAlignment="Center"
                       Margin="0,4,0,0"/>
        </StackPanel>

        <!-- FORM -->
        <ScrollViewer Grid.Row="1">
            <StackPanel>

                <!-- FILTER -->
                <TextBlock Text="Nhóm nguyên liệu:" FontWeight="SemiBold"/>
                <ComboBox ItemsSource="{Binding Filters}"
                          SelectedItem="{Binding SelectedFilter}"
                          Height="40"
                          Margin="0,6,0,16"/>

                <!-- INGREDIENT LIST -->
                <TextBlock Text="Chọn nguyên liệu:" FontWeight="SemiBold"/>
                <ComboBox ItemsSource="{Binding FilteredIngredients}"
                          SelectedItem="{Binding SelectedIngredient}"
                          DisplayMemberPath="IngredientName"
                          Height="40"
                          Margin="0,6,0,16"/>

                <!-- INGREDIENT INFO (readonly) -->
                <Border Background="#ECF0F1"
        CornerRadius="8"
        Padding="12"
        Margin="0,0,0,16"
        Visibility="{Binding SelectedIngredient,
                             Converter={StaticResource NullToVisibilityConverter}}">
                    <StackPanel>

                        <TextBlock>
            <Run Text="Mã: " FontWeight="SemiBold"/>
            <Run Text="{Binding SelectedIngredient.IngredientId}"/>
                        </TextBlock>

                        <TextBlock Margin="0,4,0,0">
            <Run Text="Đơn vị: " FontWeight="SemiBold"/>
            <Run Text="{Binding SelectedIngredient.Unit}"/>
                        </TextBlock>

                        <TextBlock Margin="0,4,0,0">
            <Run Text="Thời hạn: " FontWeight="SemiBold"/>
            <Run Text="{Binding SelectedIngredient.MaxStorageDays}"/>
            <Run Text=" ngày"/>
                        </TextBlock>

                    </StackPanel>
                </Border>

                <!-- QUANTITY -->
                <TextBlock Text="Số lượng nhập: *" FontWeight="SemiBold"/>
                <TextBox Text="{Binding Quantity, UpdateSourceTrigger=PropertyChanged}"
                         Height="40"
                         Margin="0,6,0,16"/>

                <!-- IMPORT DATE -->
                <TextBlock Text="Ngày nhập:" FontWeight="SemiBold"/>
                <DatePicker SelectedDate="{Binding ImportDate}"
                            Height="40"
                            Margin="0,6,0,16"/>

                <!-- EXPIRY DATE -->
                <TextBlock Text="Ngày hết hạn:" FontWeight="SemiBold"/>
                <DatePicker SelectedDate="{Binding ExpiryDate}"
                            Height="40"
                            Margin="0,6,0,16"/>

                <TextBlock Text="* Ngày hết hạn sẽ tự động tính theo thời hạn của nguyên liệu"
                           FontSize="11"
                           Foreground="#999"
                           TextWrapping="Wrap"
                           Margin="0,-12,0,0"/>

            </StackPanel>
        </ScrollViewer>

        <!-- ACTIONS -->
        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Center"
                    Margin="0,20,0,0">

            <Button Content="Hủy"
                    Width="120"
                    Height="40"
                    Background="#95A5A6"
                    Foreground="White"
                    BorderThickness="0"
                    FontWeight="SemiBold"
                    Margin="0,0,12,0"
                    Command="{Binding CancelCommand}">
                <Button.Template>
                    <ControlTemplate TargetType="Button">
                        <Border CornerRadius="20" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Button.Template>
            </Button>

            <Button Content="Xác nhận nhập kho"
                    Width="160"
                    Height="40"
                    Background="#5B7FFF"
                    Foreground="White"
                    BorderThickness="0"
                    FontWeight="SemiBold"
                    Command="{Binding ConfirmCommand}">
                <Button.Template>
                    <ControlTemplate TargetType="Button">
                        <Border CornerRadius="20" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Button.Template>
            </Button>

        </StackPanel>
    </Grid>
</Window>