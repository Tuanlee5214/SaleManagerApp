<UserControl x:Class="SaleManagerApp.Views.MenuPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:converters="clr-namespace:SaleManagerApp.Helpers"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:viewmodels="clr-namespace:SaleManagerApp.ViewModels" d:DataContext="{d:DesignInstance Type=viewmodels:MenuPageViewModel}"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1200"
             Background="#F5F5F5">

    <Grid Margin="-20,0,10,0">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="0"/>
            <!-- Sidebar -->
            <ColumnDefinition/>
            <!-- Main Content -->
            <ColumnDefinition Width="406"/>
            <!-- Right Panel - Cart -->
        </Grid.ColumnDefinitions>

        <!-- Sidebar -->
        <Border Background="White" Padding="10" RenderTransformOrigin="0.5,0.5" HorizontalAlignment="Left" Width="2" Grid.ColumnSpan="2" Margin="-1,0,0,0">
            <Border.RenderTransform>
                <TransformGroup>
                    <ScaleTransform ScaleX="-1"/>
                    <SkewTransform/>
                    <RotateTransform/>
                    <TranslateTransform/>
                </TransformGroup>
            </Border.RenderTransform>
            <StackPanel>
                <!-- Logo -->
                <Border Width="50" Height="50" Background="#4A7BF7" Margin="0,10">
                    <TextBlock Text="📦" FontSize="28" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="6,0,0,0"/>
                </Border>

                <!-- Navigation Icons -->
                <Button Width="40" Height="40" Margin="0,20,0,0" Background="Transparent" BorderThickness="0">
                    <Image Width="42" Height="41" Source="/Assets/Images/house.png"/>
                </Button>
                <Button Width="40" Height="40" Margin="0,10,0,0" Background="#E3EDFF" BorderThickness="0">
                    <Image Width="40" Height="40" Source="/Assets/Images/shopping.png"/>
                </Button>
                <Button Width="40" Height="40" Margin="0,10,0,0" Background="Transparent" BorderThickness="0">
                    <Image Width="30" Height="32" Source="/Assets/Images/user.png"/>
                </Button>
                <Button Width="40" Height="40" Margin="0,10,0,0" Background="Transparent" BorderThickness="0">
                    <Image Width="24" Height="34" Source="/Assets/Images/Icon.png"/>
                </Button>

                <!-- Settings at bottom -->
                <Button Width="40" Height="40" Margin="0,300,0,0" Background="Transparent" BorderThickness="0"/>
                <Button Width="40" Height="40" Margin="0,10,0,0" Background="Transparent" BorderThickness="0"/>
            </StackPanel>
        </Border>

        <!-- Main Content Area -->
        <Grid Grid.Column="1" Margin="30,20,30,20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Header -->
                <RowDefinition Height="Auto"/>
                <!-- Navigation Tabs -->
                <RowDefinition Height="Auto"/>
                <!-- Order Status Cards -->
                <RowDefinition Height="Auto"/>
                <!-- Search & Filter -->
                <RowDefinition Height="*"/>
                <!-- Menu Items -->
            </Grid.RowDefinitions>

            <!-- Header -->
            <DockPanel Grid.Row="0" Height="60" Margin="-10,-20,-43,20" LastChildFill="False" Background="White">

                <!-- BÊN TRÁI: Title -->
                <TextBlock Text="Menu"
           FontSize="22"
           FontWeight="Bold"
           DockPanel.Dock="Left"
           VerticalAlignment="Center"
           Margin="30,0,20,0"/>

                <!-- BÊN PHẢI: Admin Info -->
                <StackPanel DockPanel.Dock="Right"
            Orientation="Vertical"
            HorizontalAlignment="Right"
            Margin="0,0,20,0"
            VerticalAlignment="Center">
                    <TextBlock Text=""
               FontSize="14"
               FontWeight="SemiBold"
               HorizontalAlignment="Right"/>
                    <TextBlock Text=""
               FontSize="12"
               Foreground="#666"
               HorizontalAlignment="Right"
               Margin="0,2,0,0"/>
                </StackPanel>

                <!-- Ở GIỮA: Menu -->
                <StackPanel Orientation="Horizontal"
            VerticalAlignment="Center"
            Margin="280,0,40,0">
                    
                    <TextBlock Text="Đơn hàng" Margin="0,0,30,0"
               FontSize="15" Foreground="#6B7280" FontWeight="SemiBold" Cursor="Hand" MouseLeftButtonUp="OpenRecentOrders"/>
                    <TextBlock Text="Lịch sử thanh toán"
               FontSize="15" Foreground="#6B7280" FontWeight="SemiBold" Cursor="Hand" MouseLeftButtonUp="OpenPaymentHistory"/>
                </StackPanel>

            </DockPanel>


            <!-- Order Status Cards -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,-120,0,10">
                <TextBlock Text="Đơn hàng gần đây" FontSize="15" FontWeight="SemiBold" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="0,0,20,0"/>
            </StackPanel>

            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,40,0,20">
                <ItemsControl ItemsSource="{Binding RecentOrders}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>

                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border CornerRadius="15" Background="White" Padding="20" Width="235" Margin="0,0,20,0">
                                <StackPanel>
                                    <DockPanel Margin="0,0,0,10">
                                        <TextBlock Text="🛒" FontSize="14" Foreground="#666"/>
                                        <TextBlock Text="{Binding OrderId}" FontSize="14" FontWeight="SemiBold" Foreground="#666" Margin="5,0,0,0"/>
                                        <TextBlock Text="{Binding ItemCount, StringFormat={}{0:N0} món}" FontWeight="SemiBold" FontSize="13" Foreground="#666" HorizontalAlignment="Right"/>

                                    </DockPanel>
                                    <Border CornerRadius="15" Width="196" Padding="12,6" HorizontalAlignment="Center" Background="{Binding StatusColor}">
                                        <TextBlock Text="{Binding StatusText}" FontSize="13" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" FontWeight="SemiBold"/>
                                    </Border>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>



            </StackPanel>

            <!-- Menu Section with Search -->
            <StackPanel Grid.Row="3" Margin="0,30,0,10">
                <DockPanel Margin="0,0,0,15">
                    <TextBlock Text="Menu (Tổng số món)" FontSize="15" VerticalAlignment="Center" FontWeight="SemiBold" DockPanel.Dock="Left"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <TextBox Width="300"
     Height="40"
     Background="White"
     BorderBrush="#DDD"
     BorderThickness="1"
     FontSize="14"
     Padding="-5,10,15,10"
     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}">
                            <TextBox.Template>
                                <ControlTemplate TargetType="TextBox">
                                    <Border Background="{TemplateBinding Background}"
                BorderBrush="{TemplateBinding BorderBrush}"
                BorderThickness="{TemplateBinding BorderThickness}"
                CornerRadius="15">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="40"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- Icon search -->
                                            <TextBlock Text="🔍"
                           FontSize="16"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"
                           Foreground="Black"
                           IsHitTestVisible="False"/>

                                            <!-- Text input -->
                                            <ScrollViewer x:Name="PART_ContentHost"
                              Grid.Column="1"/>
                                        </Grid>
                                    </Border>
                                </ControlTemplate>
                            </TextBox.Template>
                        </TextBox>


                        <!-- Nút Search -->
                        <Button Width="40"
    Height="40"
    Background="White"
    BorderBrush="#DDD"
    BorderThickness="1"
    Margin="10,0"
    Command="{Binding OpenInsertCustomerFormCommand}"                        >
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}"
                BorderBrush="{TemplateBinding BorderBrush}"
                BorderThickness="{TemplateBinding BorderThickness}"
                CornerRadius="20">
                                        <ContentPresenter HorizontalAlignment="Center"
                              VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>

                            <TextBlock Text="👤" FontSize="22"/>
                        </Button>

                        <!-- Nút "+" -->
                        <Button Width="40"
    Height="40"
    Background="#4A7BF7"
    BorderThickness="0"
    HorizontalContentAlignment="Center"
    VerticalContentAlignment="Center"
    Command="{Binding OpenInsertMenuItemFormCommand}">

                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}"
                CornerRadius="20"
                Padding="{TemplateBinding Padding}">

                                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>

                            <TextBlock Text="+" 
           FontSize="24" 
           Foreground="White" 
           FontWeight="Bold"
           Margin="0,-3.7,0.5,0"                        />
                        </Button>


                    </StackPanel>
                </DockPanel>

                <!-- Category Tabs -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                    <StackPanel.Resources>
                        <Style TargetType="Button">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                            CornerRadius="20"
                            Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </StackPanel.Resources>
                    <!--Button All-->
                    <Button Width="100"
            Padding="0,10"
            BorderThickness="0"
            Margin="0,0,20,0"
            Command="{Binding SelectAllCommand}">

                        <Button.Style>
                            <Style TargetType="Button">

                                <!-- Trạng thái mặc định -->
                                <Setter Property="Background" Value="White"/>
                                <Setter Property="Foreground" Value="Black"/>

                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="ButtonBorder"
                            Background="{TemplateBinding Background}"
                            CornerRadius="20"
                            Padding="{TemplateBinding Padding}">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock x:Name="Icon"
                                       Text="📦"
                                       FontSize="16"
                                       Margin="10,0,0,0"
                                       Foreground="{TemplateBinding Foreground}"/>
                                                    <TextBlock x:Name="Label"
                                       Text="Tất cả"
                                       FontSize="14"
                                       FontWeight="SemiBold"
                                       Margin="6,0,0,0"
                                       Foreground="{TemplateBinding Foreground}"/>
                                                </StackPanel>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>

                                <!-- Khi được chọn -->
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedType}" Value="Tất cả">
                                        <Setter Property="Background" Value="#4A7BF7"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </DataTrigger>
                                </Style.Triggers>

                            </Style>
                        </Button.Style>
                    </Button>

                    <!--Button Thịt bò-->
                    <Button Width="100"
                        Padding="0,10"
                        BorderThickness="0"
                        Margin="0,0,20,0"
                        Command="{Binding SelectBeefCommand}">

                        <Button.Style>
                            <Style TargetType="Button">

                                <!-- Trạng thái mặc định -->
                                <Setter Property="Background" Value="White"/>
                                <Setter Property="Foreground" Value="Black"/>

                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="ButtonBorder"
                                                  Background="{TemplateBinding Background}"
                                                  CornerRadius="20"
                                                  Padding="{TemplateBinding Padding}">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock x:Name="Icon"
                                                            Text="🥩"
                                                            FontSize="16"
                                                            Margin="10,0,0,0"
                                                            Foreground="{TemplateBinding Foreground}"/>
                                                    <TextBlock x:Name="Label"
                                                             Text="Thịt bò"
                                                             FontSize="14"
                                                             FontWeight="SemiBold"
                                                             Margin="6,0,0,0"
                                                             Foreground="{TemplateBinding Foreground}"/>
                                                </StackPanel>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <!-- Khi được chọn -->
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedType}" Value="Thịt bò">
                                        <Setter Property="Background" Value="#4A7BF7"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <!--Thịt heo-->
                    <Button Width="100"
                        Padding="0,10"
                        BorderThickness="0"
                        Margin="0,0,20,0"
                        Command="{Binding SelectPorkCommand}">

                        <Button.Style>
                            <Style TargetType="Button">

                                <!-- Trạng thái mặc định -->
                                <Setter Property="Background" Value="White"/>
                                <Setter Property="Foreground" Value="Black"/>

                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="ButtonBorder"
                              Background="{TemplateBinding Background}"
                              CornerRadius="20"
                              Padding="{TemplateBinding Padding}">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock x:Name="Icon"
                                        Text="🍖"
                                        FontSize="16"
                                        Margin="10,0,-2,0"
                                        Foreground="{TemplateBinding Foreground}"/>
                                                    <TextBlock x:Name="Label"
                                         Text="Thịt heo"
                                         FontSize="14"
                                         FontWeight="SemiBold"
                                         Margin="6,0,0,0"
                                         Foreground="{TemplateBinding Foreground}"/>
                                                </StackPanel>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <!-- Khi được chọn -->
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedType}" Value="Thịt heo">
                                        <Setter Property="Background" Value="#4A7BF7"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <!--Thịt gà-->
                    <Button Width="100"
                        Padding="0,10"
                        BorderThickness="0"
                        Margin="0,0,20,0"
                        Command="{Binding SelectChickenCommand}">

                        <Button.Style>
                            <Style TargetType="Button">

                                <!-- Trạng thái mặc định -->
                                <Setter Property="Background" Value="White"/>
                                <Setter Property="Foreground" Value="Black"/>

                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="ButtonBorder"
                                                  Background="{TemplateBinding Background}"
                                                  CornerRadius="20"
                                                  Padding="{TemplateBinding Padding}">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock x:Name="Icon"
                                                             Text="🍱"
                                                             FontSize="16"
                                                             Margin="10,-3,-2,0"
                                                             Foreground="{TemplateBinding Foreground}"/>
                                                    <TextBlock x:Name="Label"
                                                             Text="Thịt gà"
                                                             FontSize="14"
                                                             FontWeight="SemiBold"
                                                             Margin="6,0,0,0"
                                                             Foreground="{TemplateBinding Foreground}"/>
                                                </StackPanel>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <!-- Khi được chọn -->
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedType}" Value="Thịt gà">
                                        <Setter Property="Background" Value="#4A7BF7"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <!--Button món khác -->
                    <Button Width="100"
                        Padding="0,10"
                        BorderThickness="0"
                        Margin="0,0,20,0"
                        Command="{Binding SelectAnotherCommand}">

                        <Button.Style>
                            <Style TargetType="Button">

                                <!-- Trạng thái mặc định -->
                                <Setter Property="Background" Value="White"/>
                                <Setter Property="Foreground" Value="Black"/>

                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="ButtonBorder"
                              Background="{TemplateBinding Background}"
                              CornerRadius="20"
                              Padding="{TemplateBinding Padding}">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock x:Name="Icon"
                                         Text="🍽️"
                                         FontSize="16"
                                         Margin="8,-1,-5,0"
                                         Foreground="{TemplateBinding Foreground}"/>
                                                    <TextBlock x:Name="Label"
                                         Text="Món khác"
                                         FontSize="14"
                                         FontWeight="SemiBold"
                                         Margin="6,0,0,0"
                                         Foreground="{TemplateBinding Foreground}"/>
                                                </StackPanel>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <!-- Khi được chọn -->
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedType}" Value="Món khác">
                                        <Setter Property="Background" Value="#4A7BF7"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <!--Nước uống-->
                    <Button Width="100"
                        Padding="0,10"
                        BorderThickness="0"
                        Margin="0,0,10,0"
                        Command="{Binding SelectDrinkCommand}">

                        <Button.Style>
                            <Style TargetType="Button">

                                <!-- Trạng thái mặc định -->
                                <Setter Property="Background" Value="White"/>
                                <Setter Property="Foreground" Value="Black"/>

                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="ButtonBorder"
                                                        Background="{TemplateBinding Background}"
                                                        CornerRadius="20"
                                                        Padding="{TemplateBinding Padding}">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock x:Name="Icon"
                                                             Text="🥤"
                                                             FontSize="16"
                                                             Margin="1,-1,-8,0"
                                                             Foreground="{TemplateBinding Foreground}"/>
                                                    <TextBlock x:Name="Label"
                                                             Text="Nước uống"
                                                             FontSize="14"
                                                             FontWeight="SemiBold"
                                                             Margin="8,0,0,0"
                                                             Foreground="{TemplateBinding Foreground}"/>
                                                </StackPanel>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <!-- Khi được chọn -->
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedType}" Value="Nước uống">
                                        <Setter Property="Background" Value="#4A7BF7"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <Button Width="100" Height="40" Margin="180,0,0,0" Background="#4A7BF7" Foreground="White" FontWeight="SemiBold" VerticalAlignment="Center"
                        Command="{Binding OpenListTableWindowCommand}">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}"
BorderBrush="{TemplateBinding BorderBrush}"
BorderThickness="1"
CornerRadius="15">
                                    <!-- Bo viền -->
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                        📍Chi tiết bàn
                    </Button>
                </StackPanel>
            </StackPanel>

            <!-- Menu Items Grid -->

            <!-- Menu Items Grid -->
            <ScrollViewer Grid.Row="4" VerticalScrollBarVisibility="Auto">
                <ItemsControl ItemsSource="{Binding MenuItems}">

                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>

                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Width="225"
                    Margin="0,0,15,15"
                    CornerRadius="20"
                    Background="White">

                                <Border.Effect>
                                    <DropShadowEffect Color="Gray"
                                      BlurRadius="10"
                                      ShadowDepth="2"
                                      Opacity="0.2"/>
                                </Border.Effect>

                                <StackPanel>

                                    <!-- IMAGE -->
                                    <Image Source="{Binding imageFullPath}"
                           Height="180"
                           Margin="15,15,15,10"
                           Stretch="UniformToFill"/>

                                    <StackPanel Margin="15,0,15,15">

                                        <!-- NAME -->
                                        <TextBlock Text="{Binding menuItemName}"
                                   FontSize="14"
                                   FontWeight="SemiBold"
                                   TextTrimming="CharacterEllipsis"
                                   Margin="0,0,0,10"/>

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- PRICE -->
                                            <TextBlock Text="{Binding unitPriceDisplay}"
                                       FontSize="14"
                                       FontWeight="SemiBold"
                                       Foreground="#4A7BF7"
                                       VerticalAlignment="Center"/>

                                            <!-- ACTION -->
                                            <Grid Grid.Column="1">
                                                <Grid>

                                                    <!-- ADD -->
                                                    <Button Width="32"
    Height="32"
    Background="Transparent"
    BorderThickness="0"
    Command="{Binding DataContext.AddToCartCommand,
              RelativeSource={RelativeSource AncestorType=ItemsControl}}"
    CommandParameter="{Binding}">

                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="Visibility" Value="Visible"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding DisplayQuantity}" Value="0">
                                                                        <Setter Property="Visibility" Value="Visible"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding DisplayQuantity}" Value="1">
                                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>

                                                        <Button.Template>
                                                            <ControlTemplate TargetType="Button">
                                                                <Border Width="32"
                Height="32"
                CornerRadius="16"
                BorderBrush="#4A7BF7"
                BorderThickness="1.5"
                Background="White">
                                                                    <TextBlock Text="+"
                       FontSize="22"
                       FontWeight="Bold"
                       Foreground="#4A7BF7"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Margin="0,0,0,5"/>
                                                                </Border>
                                                            </ControlTemplate>
                                                        </Button.Template>
                                                    </Button>



                                                    <!-- QTY -->
                                                    <Border Background="#F0F0F0"
                                                        CornerRadius="16"
                                                        Height="32"
                                                        MinWidth="85">

                                                        <Border.Style>
                                                            <Style TargetType="Border">
                                                                <Setter Property="Visibility" Value="Visible"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding DisplayQuantity}" Value="0">
                                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Border.Style>

                                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">

                                                            <Button Command="{Binding DataContext.DecreaseCommand,
                          RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                CommandParameter="{Binding}"
                Width="28" Background="Transparent" BorderThickness="0">
                                                                <TextBlock Text="-" FontSize="20" FontWeight="Bold"/>
                                                            </Button>

                                                            <TextBlock Text="{Binding DisplayQuantity}"
                   FontSize="15"
                   FontWeight="Bold"
                   MinWidth="20"
                   TextAlignment="Center"
                   VerticalAlignment="Center"/>

                                                            <Button Command="{Binding DataContext.IncreaseCommand,
                          RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                CommandParameter="{Binding}"
                Width="28" Background="Transparent" BorderThickness="0">
                                                                <TextBlock Text="+" FontSize="18" FontWeight="Bold"/>
                                                            </Button>

                                                        </StackPanel>
                                                    </Border>
                                                </Grid>

                                            </Grid>
                                        </Grid>

                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>


        </Grid>

        <!-- Right Panel - Cart/Order Summary -->
        <Border Grid.Column="2" Background="White" Padding="25" Margin="0,0,-10,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header -->
                <StackPanel Grid.Row="0" Margin="0,0,0,20">
                    <TextBlock Text="Đơn hàng hiện tại" HorizontalAlignment="Left" FontSize="24" FontWeight="Bold" Margin="0,0,0,0"/>
                </StackPanel>

                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,15">
                    <TextBlock Text="Mã đơn hàng hiện tại: "
           FontSize="14"
           FontWeight="SemiBold"/>

                    <TextBlock Text="{Binding CurrentOrderId}"
           FontSize="14"
           FontWeight="Bold"
           Foreground="DarkBlue"/>
                </StackPanel>
                <StackPanel Grid.Row="2" Margin="0,0,0,15">

                    <!-- Trạng thái -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="70"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0"
               Text="Trạng thái:"
               FontSize="14"
               FontWeight="SemiBold"
               VerticalAlignment="Center"/>

                        <ComboBox Grid.Column="1"
              Width="200"
              ItemsSource="{Binding OrderTypes}"
      SelectedItem="{Binding SelectedOrderType}"
      DisplayMemberPath="Display"/>
                    </Grid>

                    <!-- Chọn bàn -->
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="70"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0"
               Text="Chọn bàn:"
               FontSize="14"
               FontWeight="SemiBold"
               VerticalAlignment="Center"/>

                        <ComboBox Grid.Column="1"
              Width="200"
              ItemsSource="{Binding Tables}"
              DisplayMemberPath="tableName"
              SelectedValuePath="tableId"
              SelectedValue="{Binding SelectedTableId}"
              IsEnabled="{Binding IsTableSelectionEnabled}"
              DropDownOpened="TableComboBox_DropDownOpened"/>
                    </Grid>

                </StackPanel>


                <!-- Order Items Header -->
                <TextBlock Grid.Row="3" Text="Thông tin món (Số món ăn)" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,15"/>

                <!-- Order Items List -->
                <Border Grid.Row="4"
    BorderBrush="#E0E0E0"
    BorderThickness="1"
    CornerRadius="12"
    Padding="5">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding CartItems}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Padding="10"
                    Margin="0,0,0,10"
                    BorderThickness="1"
                    BorderBrush="#E0E0E0"
                    CornerRadius="8">

                                        <DockPanel>

                                            <!-- DELETE -->
                                            <Button DockPanel.Dock="Right"
                            Content="🗑"
                            FontSize="16"
                            Foreground="Red"
                            Background="Transparent"
                            BorderThickness="0"
                            Command="{Binding DataContext.RemoveItemCommand,
                                      RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                            CommandParameter="{Binding}"/>

                                            <!-- IMAGE -->
                                            <Image DockPanel.Dock="Left"
                           Width="50"
                           Height="50"
                           Margin="0,0,10,0"
                           Source="{Binding ImageUrl}"
                           Stretch="UniformToFill"/>

                                            <!-- INFO -->
                                            <StackPanel VerticalAlignment="Center">

                                                <TextBlock Text="{Binding MenuItemName}"
                                   FontWeight="SemiBold"/>

                                                <TextBlock Text="{Binding UnitPrice, StringFormat={}{0:N0} đ}"
                                   Foreground="#666"/>
                                                <TextBlock Text="{Binding Quantity, StringFormat=x{0}}"
                             FontSize="12" FontWeight="Bold"/>


                                            </StackPanel>


                                        </DockPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>


                </Border>


                <!-- Payment Summary -->
                <StackPanel Grid.Row="5" Margin="0,20,0,0">
                    <TextBlock Text="Thông tin thanh toán" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,15"/>

                    <DockPanel Margin="0,0,0,8">
                        <TextBlock Text="Tổng giá trị" FontSize="13" Foreground="#666"/>
                        <TextBlock Text="{Binding TotalAmount,
                                                  StringFormat={}{0:N0} VND}" FontSize="13" HorizontalAlignment="Right"/>
                    </DockPanel>

                    <DockPanel Margin="0,0,0,8">
                        <TextBlock Text="Phí" FontSize="13" Foreground="#666"/>
                        <TextBlock Text="0 VND" FontSize="13" HorizontalAlignment="Right"/>
                    </DockPanel>

                    <DockPanel Margin="0,0,0,15">
                        <TextBlock Text="Giảm giá" FontSize="13" Foreground="#666"/>
                        <TextBlock Text="0%" FontSize="13" HorizontalAlignment="Right"/>
                    </DockPanel>

                    <Border BorderBrush="#E0E0E0" BorderThickness="0,1,0,0" Padding="0,15,0,0">
                        <Grid Margin="0,10,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Label -->
                            <TextBlock Grid.Column="0"
           Text="Tổng"
           FontSize="15"
           FontWeight="Bold"/>

                            <!-- Amount -->
                            <TextBlock Grid.Column="1"
           Text="{Binding TotalAmount, StringFormat={}{0:N0} VND}"
           FontSize="16"
           FontWeight="Bold"
           Foreground="#4A7BF7"
           HorizontalAlignment="Right"/>
                        </Grid>
                    </Border>
                </StackPanel>

                <!-- Save Button -->
                <Button x:Name="BtnSaveOrder"
    Grid.Row="6"
    Background="#4A7BF7"
    BorderThickness="0"
    Height="50"
    Margin="0,20,0,0"
    Command="{Binding SaveOrder}">

                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}"
                CornerRadius="20"
                Padding="{TemplateBinding Padding}">
                                <ContentPresenter HorizontalAlignment="Center"
                              VerticalAlignment="Center"/>
                            </Border>
                        </ControlTemplate>
                    </Button.Template>

                    <TextBlock Text="Lưu đơn hàng"
           FontSize="15"
           Foreground="White"
           FontWeight="SemiBold"/>
                </Button>
            </Grid>
        </Border>

        <!-- User Info (Top Right) -->

    </Grid>
</UserControl>